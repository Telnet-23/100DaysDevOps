## The Problem

We have a web server container running the nginx image. The access and error logs generated by the web server are not critical enough to be placed on a persistent volume. However, 
Nautilus developers need access to the last 24 hours of logs so that they can trace issues and bugs. Therefore, we need to ship the access and error logs for the web server to a 
log-aggregation service. Following the separation of concerns principle, we implement the Sidecar pattern by deploying a second container that ships the error and access logs from nginx. 
Nginx does one thing, and it does it well—serving web pages. The second container also specializes in its task—shipping logs. Since containers are running on the same Pod, we can use a 
shared emptyDir volume to read and write logs.

1. Create a pod named webserver.

2. Create an emptyDir volume shared-logs.

3. Create two containers from nginx and ubuntu images with latest tag only and remember to mention tag i.e nginx:latest, nginx container name should be nginx-container and ubuntu
   container name should be sidecar-container on webserver pod.

4. Add command on sidecar-container "sh","-c","while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"

## The Solution

First I created the manifest ``` vi webserver.yaml ```

The I had to build the manifest which presented its own challenges. I'm come to a conclusion that yaml is the devils work. 

```
apiVersion: v1
kind: Pod
metadata:
  name: webserver
spec:
  volumes:
  - name: shared-logs
    emptyDir: {}
  containers:
  - name: nginx-container
    image: nginx:latest
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/nginx
  - name: sidecar-container
    image: ubuntu:latest
    command: ["sh","-c","while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"]
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/nginx

```

Then it was time to apply the pod and pray ```kubectl apply -f webserver.yaml```

As always, inspect the pod to make sure its up and running ```kubectl describe pod webserver```

I then found after much searching that there is a way to view the logs in the side car ```kubectl logs -f webserver -c sidecar-container```

## Thoughts and takeaways

Sidecar seems like a really cool feature. My issue is that I really havent played with Kubernetes much and these challenges are getting harder. I guess thats the point though right? 
I'll keep learning and building this repo will be my reminder that I have done this before so I can do it. Eventualy I guess like all new skills in technology, it just becomes second nature. 

